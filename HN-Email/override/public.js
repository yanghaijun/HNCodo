String.prototype.trim=function(){    var r = this.replace(/(^\s*)|(\s*$)/g,"");     r = Lremoveblank(r);      r = Rremoveblank(r);      return r;  }function Lremoveblank(s) {      if (s.length == 1 && s.charCodeAt(0) == 160)          return "";      if (s.charCodeAt(0) == 160) {          s = s.substr(1, s.length - 1);          return Lremoveblank(s);      }      else {          return s;      }  }function Rremoveblank(s) {      if (s.length == 1 && s.charCodeAt(0) == 160)          return "";      if (s.charCodeAt(s.length-1) == 160) {          s = s.substr(0, s.length - 1);          return Rremoveblank(s);      }      else {          return s;      }  }  String.prototype.leftback=function(pos){    if (typeof pos==='string'){        return this.substring(0,this.lastIndexOf(pos));    }else{        return this.substr(0,this.length-pos);    }}	String.prototype.left=function(pos){    if (typeof pos==='string'){        return this.substring(0,this.indexOf(pos));    }else{        return this.substr(0,pos);    }}String.prototype.right=function(pos){    if (typeof pos==='string'){        if(this.indexOf(pos)===-1){            return "";        }else{            return this.substring(this.indexOf(pos)+pos.length);        }    }else{        return this.substr(this.length-pos);    }}String.prototype.rightback=function(pos){    if (typeof pos==='string'){        if(this.indexOf(pos)===-1){            return "";        }else{            return this.substring(this.lastIndexOf(pos)+pos.length);        }    }else{        return this.substr(pos);    }}String.prototype.strToken=function(index,seperator){return this.split(seperator)[index-1];}String.prototype.strReplaceWord=function(index,seperator,newValue){    var vRet=this.split(seperator);    vRet[index-1]=newValue;    return vRet.join(seperator);}String.prototype.replaceAll = function(s1,s2) {     return this.replace(new RegExp(s1,"gm"),s2); }function ArrayReplace(vSource,vFrom,vTo,cmpFun){    var arrFrom=typeof(vFrom)!=='object'?[vFrom]:vFrom;    var arrTo=typeof(vTo)!=='object'?[vTo]:vTo;    var arrRet=vSource;    for(var i=0;i<arrRet.length;i++){        for (j=0;j<arrFrom.length;j++){            if (typeof(cmpFun)==='function'){                if (cmpFun.call(null,arrRet[i],arrFrom[j])){arrRet[i]=arrTo[j];}            }else if (arrRet[i]===arrFrom[j]){                arrRet[i]=arrTo[j];            }        }    }    return arrRet;}function FullTrim(vSource,cmpFun){    var arrRet=[];    var tmp;    for(var i=0;i<vSource.length;i++){        tmp=vSource[i].trim();        if (typeof(cmpFun)==='function'){            if (cmpFun.call(null,tmp)){arrRet.push(tmp);}        }else if (tmp){            arrRet.push(tmp);        }    }    return arrRet;}function ArrayGetIndex(vSource,item,cmpFun){    var index=-1;    for(i=0;i<vSource.length;i++){        if (typeof(cmpFun)==='function'){            if (cmpFun.call(null,vSource[i],item)){return i;}        }else if (vSource[i]===item){            return i;        }    }    return index;}function ArrayUnique(vSource,cmpFun){    var vRet=[];    for(var i=0;i<vSource.length;i++){        if (ArrayGetIndex(vRet,vSource[i],cmpFun)===-1){            vRet.push(vSource[i])        }    }    return vRet}function GetItemValue(itemName,silent){    if (!itemName) return("");    var item = getElement(itemName);    if (item){        return item.value;    }else if (!silent){        alert("\u8868\u5355\u4E2D\u6CA1\u6709\u6307\u5B9A\u7684\u57DF[" + itemName + "],\u65E0\u6CD5\u63D0\u53D6\u57DF\u503C");    }else {return("")}}function SetItemValue(itemName,value,silent){    if (!itemName ) return("");    var item = getElement(itemName);    if (item){        item.value=value;    }else if (!silent){        alert("\u8868\u5355\u4E2D\u6CA1\u6709\u6307\u5B9A\u7684\u57DF[" + itemName + "],\u65E0\u6CD5\u63D0\u53D6\u57DF\u503C");    }}function map (fn) {    var tmpList=[];    var count=0;    for (var i = 1; i < arguments.length; i++) {        if (arguments[i].length>count) count=arguments[i].length;    }    for (var i = 0; i < count; i++) {        var arg=[];        for (var j = 1; j < arguments.length; j++) {            arg.push(arguments[j][i])        }        if (fn) {            tmpList.push(fn.apply(null,arg));        }else tmpList.push(arg);    }    return tmpList;}function reduce (fn,list,initValue) {    var tmpList=[];    var start=1;    if (initValue!==undefined) {        start=0;    }else{        initValue=list[0];    }    for (var start = 0; start < list.length; start++) {        var l=list[start];        var tmpValue=fn(initValue,l);        tmpList.push(tmpValue);        initValue=tmpValue;    }    return tmpList;}//\u9690\u85CFfunction hidd_line(ids){    ids=ids.split(",");    for (j=0;j<ids.length;j++){        getElement(ids[j]).style.display="none";    }}//\u663E\u793Afunction show_line(ids){    ids=ids.split(",");    for (j=0;j<ids.length;j++){        getElement(ids[j]).style.display="block";    }}//\u529E\u7406\u610F\u89C1\u6298\u53E0\u5C55\u5F00function ShowHide(id){    //var obj=$("#"+id);    var trs=$("tr[id="+ id +"]");    if (trs[0].style.display=="none"){       $("#img"+ id)[0].src="/" + SysDBPath + "/" +"folderNoSub.gif"    }else{        $("#img"+ id)[0].src="/" + SysDBPath + "/" +"folderHaveSub.gif"    }   trs.toggle();    /*    var img=getElement("img"+id);    for(j=0;j<obj.length;j++){        if(obj[j].style.display=="none"){            obj[j].style.display="block";            img.src="/" + SysDBPath + "/" +"folderNoSub.gif"        }else{            obj[j].style.display="none";            img.src="/" + SysDBPath + "/" +"folderHaveSub.gif"        }    }    */}//notes\u9644\u4EF6\u63A7\u4EF6\u5220\u9664\u9644\u4EF6function DelAtt(selname,itemname,divid,config){    var Detach="";    var objSel=document.getElementsByName(selname)    if(objSel.length!=null){        for (i=0;i<objSel.length;i++){            if(objSel[i].checked){                if(Detach==""){                    Detach=objSel[i].value;                }else{                    Detach=Detach+","+objSel[i].value;                }            }        }    }    var unid;    if (config && config.unid){unid=config.unid}else{unid=GetItemValue("unid")}    if (Detach!=""){        var url="/"+GetItemValue("SysDBPath") +"/AgentDelAtt?openagent";        var parameter="&AttDBPath="+GetItemValue("DBPath")+"&AttDocUNID="+unid+"&rtitemname="+itemname+"&Detach="+escape(Detach);        var tempstr=ajaxFunction(url,parameter);        if (tempstr=="OK"){            /*            for (i=0;i<document.getElementsByName(selname).length;i++){            if(document.getElementsByName(selname)[i].checked){            document.getElementsByName(selname)[i].checked=false;            document.getElementById(divid+i).style.display="none";            }            }            */            location.href=location.href;        }    }}//\u5173\u95ED\u89C6\u56FE\u4E0A\u6253\u5F00\u7684\u6587\u6863\uFF0C\u53EF\u4EE5\u662F\u65B0\u7A97\u53E3\u6253\u5F00\u6216\u8005\u65B0tab\u6253\u5F00function CloseDoc(tempstr, silent) {    if (!silent && typeof(window.beforeCloseDoc)=='function'){        if (beforeCloseDoc.call(window)===false){return false;}    }    var fldName = "LinkTarget1";    if (getElement(fldName) == null) {        fldName = "LinkTarget";    }    if (GetItemValue(fldName,true)=="NewTabWindow"){        try{            if(tempstr=="reload"){                window.parent.Ext.getCmp("tabgrid").store.reload();            }        }catch(e){}        removeTabFromIframe(GetItemValue('TabID',true));    }else if(GetItemValue(fldName,true).indexOf("drag")>=0){//\u5237\u65B0\u4E3B\u754C\u9762\u6A21\u5757        iframex =parent.opener.parent.getElement("main_center_frame");        if(iframex){            iframex.contentWindow.callrefresh(GetItemValue(fldName,true));        }        window.close();    }else{        try{            if(tempstr=="reload"){                window.opener.Ext.getCmp("tabgrid").store.reload();            }        }catch(e){};        if(getElement('OpenType')&&GetItemValue('OpenType')=="call-board"){            var objtabid=window.parent.Ext.getCmp(GetItemValue('TabID',true));            objtabid.ownerCt.remove(objtabid);        }else{            window.close();        }    }}//\u5168\u9009/\u53D6\u6D88function SelAll(obj,checkType){    for (i=0;i<obj.length;i++){        if(obj[i].parentNode.style.display!="none"){            if(checkType==true){                obj[i].checked=checkType;            }else{                obj[i].checked=checkType;            }        }    }}//\u68C0\u6D4B\u6587\u672C\u6846\u662F\u5426\u4E3A\u7A7Afunction CheckTextbox(item,prompt){    var msg = "";    var strvalue = GetItemValue(item);    if(strvalue.replace(/(^[\s\u3000]*)|([\s\u3000]*$)/g,"") == ""){        msg = "\u8BF7\u586B\u5199" + prompt + "\uFF01\n";        try{getElement(item + "1").style.border = "1px solid red";}        catch(e){getElement(item).style.border = "1px solid red";}    }    return msg;}//\u68C0\u6D4B\u5355\u9009\u6309\u94AE\u662F\u5426\u5DF2\u9009\u62E9function CheckRadiobutton(item,prompt){    var msg = "";    var radiobutton = document.getElementsByName(item);    var checkflag = false;for(var i=0;i<radiobutton.length;i++){if(radiobutton[i].checked){checkflag = true;}}    if(checkflag == false){msg = "\u8BF7\u9009\u62E9" + prompt + "\uFF01\n";}    return msg;}//\u9A8C\u8BC1\u6570\u5B57\uFF0C\u4F20\u5165\u5B57\u6BB5\u540Dfunction ExitingItem(item){    var o;    if(typeof(item)=="object"){        o=item    }else{        o=getElement(item)    }    if(isNaN(o.value)){        o.style.border = "1px solid red";        alert('\u6570\u636E\u7C7B\u578B\u9519\u8BEF,\u5FC5\u987B\u4E3A\u6570\u5B57\uFF01');        o.value = "";		    }    return false}//\u83DC\u5355\u4E0B\u62C9\u6309\u94AEfunction show(aObj){    clearTimeout(aObj.timeSpan);    $("#Toolbar").removeAttr("style");    aObj.className="dropdown";    var menu = getElement(aObj.id + "_menu");    menu.style.display = "block";    if (aObj.getBoundingClientRect().bottom + menu.offsetHeight > document.documentElement.clientHeight){        //alert(menu.offsetHeight)        menu.style.top = "0px";    }    else    {        menu.style.top = "0px";    }    menu.onmouseout = aObj.onmouseout = function(){        aObj.timeSpan = setTimeout("hide('"+aObj.id+"')",0);    }    menu.onmouseover = function (){clearTimeout(aObj.timeSpan);}}//\u83DC\u5355\u4E0B\u62C9\u6309\u94AEfunction hide(id){    $("#Toolbar").attr("style","overflow:hidden");    getElement(id).className="drop";    getElement(id + "_menu").style.display = "none";}//\u5F39\u51FA\u7A97\u53E3function OpenExtWindow(ID,Url,Title,widthx,heightx,buttons,callbackstr,parentext){    buttonAlign="right";    var CallBackParm=[];    var closedFlag=false;    if(parentext == "parent"){        Ext = parent.Ext;    }    ID = ID||"extwin";    var iframeid = "iframe" + ID;    var win = new Ext.Window({        id           : ID,        title	     : Title,        width	     : widthx,        clickedbutton:'\u53D6\u6D88',        height	     : heightx,        autoDestroy	 : true,        resizable    : false,        modal	     : true,        html	     : '<iframe id="' + iframeid + '" name="' + iframeid + '" src="' + Url + '" width="100%" height="100%" scrolling="no"frameborder="0" marginwidth="0" marginheight="0"></iframe>',        buttonAlign  : buttonAlign    });    if (buttons){        if(buttons.indexOf("g") != -1){            win.addButton({text:'\u5E38\u7528\u8BBE\u7F6E'},function(){                win.clickedbutton = "\u5E38\u7528\u8BBE\u7F6E";                var iframex = GetIframeObj(parentext,iframeid);                if(callbackstr != ""){                    if (typeof(callbackstr) == "function"){//\u4F20\u5165\u7684\u76F4\u63A5\u662F\u56DE\u8C03\u51FD\u6570                        callbackstr.call(null,CallBackParm,"g");                    }else{                        eval(callbackstr);                    }                }            });        }        if(buttons.indexOf("c") != -1){            win.addButton({text:'\u5168\u9009'},function(){                win.clickedbutton = "\u5168\u9009";                var iframex = GetIframeObj(parentext,iframeid);                iframex.ReturnValue("c");            });        }        if(buttons.indexOf("d") != -1){            win.addButton({text:'\u53CD\u9009'},function(){                win.clickedbutton = "\u53CD\u9009";                var iframex = GetIframeObj(parentext,iframeid);                iframex.ReturnValue("d");            });        }        if(buttons.indexOf("s") != -1){            win.addButton({text:'\u6682\u5B58\u610F\u89C1'},function(){                var iframex = GetIframeObj(parentext,iframeid);                if (iframex.SaveYJ()==false){                    return false;                }                win.close();            });        }        if(buttons.indexOf("n") != -1){            win.addButton({text:'\u5F55\u5165\u4E0B\u4E00\u6761'},function(){                var iframex = GetIframeObj(parentext,iframeid);                iframex.ReturnValue("n");            });        }        if(buttons.indexOf("a") != -1){            win.addButton({text:'\u786E\u5B9A'},function(){                win.clickedbutton = "\u786E\u5B9A";                this.disabled=true;                try{                    var iframex = GetIframeObj(parentext,iframeid);                    returnvalue=iframex.ReturnValue("a",ID,parentext);                    if(returnvalue==false){                        this.disabled=false;                        return;                    }                }catch(e){this.disabled=false;}                if(callbackstr != ""){                    if (typeof(callbackstr) == "function"){//\u4F20\u5165\u7684\u76F4\u63A5\u662F\u56DE\u8C03\u51FD\u6570                        if (closedFlag){                            callbackstr.call(null,CallBackParm,"a");                        }else{                            win.on("close",function(){callbackstr.call(null,CallBackParm,"a");})                        }                    }else{                        eval(callbackstr);                    }                }            });        }        if(buttons.indexOf("f") != -1){ //\u77ED\u4FE1\u53D1\u9001\u7A97\u53E3\u53D1\u9001\u6309\u94AE            win.addButton({text:'\u53D1\u9001'},function(){                win.clickedbutton = "\u53D1\u9001";                this.disabled=true;                try{                    var iframex = GetIframeObj(parentext,iframeid);                    returnvalue=iframex.ReturnValue("a",ID,parentext);                    if(returnvalue==false){                        this.disabled=false;                    }                }catch(e){this.disabled="false";}                if(callbackstr != ""){                    eval(callbackstr);                }            });        }        if(buttons.indexOf("e") != -1){            win.addButton({text:'\u6E05\u7A7A'},function(){                if(Title=="\u589E\u52A0\u4EFB\u52A1\u6587\u4EF6"){                    var iframex = GetIframeObj(parentext,iframeid);                    iframex.ReturnValue("e");                }else{                    if(confirm("\u60A8\u786E\u5B9A\u8981\u6E05\u7A7A\u5DF2\u9009\u7684 "+Title+" \u5417\uFF1F")){                        var iframex = GetIframeObj(parentext,iframeid);                        iframex.ReturnValue("e");                        if (typeof(callbackstr) == "function"){ //\u4F20\u5165\u7684\u76F4\u63A5\u662F\u56DE\u8C03\u51FD\u6570                            callbackstr.call(null,CallBackParm,"e");                        }else{                            eval(callbackstr);                        }                        win.close();                    }else{return false;}                }            });        }        if(buttons.indexOf("b") != -1){            win.addButton({text:'\u53D6\u6D88'},function(){                win.clickedbutton = "\u53D6\u6D88";                win.close();            });        }    }    win.on("beforeclose",function(){        var iframex = GetIframeObj(parentext,iframeid);        if(iframex!=null){            CallBackParm=iframex.CallBackParm;        }        if(buttons=="" && (ID == "attach" || ID == "Attachment" || Title.indexOf("\u56DE\u9988\u6587\u4EF6")>0)){            try{                if (iframex.ReturnValue()==false){                    return false;                }            }catch(e){}            setTimeout("closewin('"+iframeid+"');",300);        }else{            closewin(iframeid);        }    })    win.on('close',function(){closedFlag=true})    win.show();    if(iframeid=="iframeSubmitToNextTask"){        win.hide();    }    return;}//\u83B7\u53D6iframefunction GetIframeObj(parentext,iframeid){    var iframex;    if(parentext == "parent"){        //iframex =parent.document.frames[iframeid];        iframex=parent.frames[iframeid]    }else{        //iframex =document.frames[iframeid];        iframex =window.frames[iframeid];    }    return iframex;}//\u6E05\u9664\u5185\u5B58function closewin(iframeid){    var iframex = Ext.getDom(iframeid);    if (iframex!=null){        iframex.src = "javascript:false";        try{CollectGarbage();}catch(e){}    }}//NTKO\u9644\u4EF6\u7BA1\u7406\u548C\u9644\u4EF6\u5C5E\u6027\u7A97\u53E3function SubAttachmentAndProperty_NTKO(RTItemName,fldQXXXSubForm){	    OnTabChange('tabjbxx','jbxx');//\u4E3A\u4E86\u9632\u6B62\u5F39\u51FA\u7A97\u53E3\u88AB\u63A7\u4EF6\u906E\u4F4F\u5148\u5207\u6362\u5230\u57FA\u672C\u4FE1\u606F    if (fldQXXXSubForm==undefined){        fldQXXXSubForm="subQXXX_Default";    }    var url = "/" + SysDBPath +"/AttachmentNamesAndProperty_NTKO?openform";    url=url+"&AttDocUNID="+GetItemValue("fldqxxxid")+"&fldadocid="+GetItemValue("fldadocid");    url=url+"&fldcdocid="+GetItemValue("fldcdocid")+"&RTItemName="+RTItemName+"&fldDBPath="+escape(DBPath);    url=url+"&fldQXXXSubForm="+fldQXXXSubForm+"&S002="+GetItemValue("S002");    url=url+"&H002="+GetItemValue("H002");    if(GetItemValue("H002")=="display:none"){        OpenExtWindow("Attachment",url,"\u9644\u4EF6\u7BA1\u7406\u5668",710,320,"");    }else{        OpenExtWindow("Attachment",url,"\u9644\u4EF6\u7BA1\u7406\u5668",710,466,"");    }}//NTKO\u9644\u4EF6\u7BA1\u7406\u7A97\u53E3function SubAttachment_NTKO(RTItemName,fldQXXXSubForm){    OnTabChange('tabjbxx','jbxx');//\u4E3A\u4E86\u9632\u6B62\u5F39\u51FA\u7A97\u53E3\u88AB\u63A7\u4EF6\u906E\u4F4F\u5148\u5207\u6362\u5230\u57FA\u672C\u4FE1\u606F    if (fldQXXXSubForm==undefined){        fldQXXXSubForm="subQXXX_Default";    }	    var url = "/" + SysDBPath +"/AttachmentNames_NTKO?openform";    url=url+"&AttDocUNID="+GetItemValue("fldqxxxid")+"&fldadocid="+GetItemValue("fldadocid");    url=url+"&fldcdocid="+GetItemValue("fldcdocid")+"&RTItemName="+RTItemName+"&fldDBPath="+escape(DBPath);    url=url+"&fldQXXXSubForm="+fldQXXXSubForm;    OpenExtWindow("Attachment",url,"\u9644\u4EF6\u7BA1\u7406\u5668",710,320,"");}var xmlHttp;function ajaxFunction(url,parameter,returntype,ajaxCallBack){    try{ // Firefox, Opera 8.0+, Safari        xmlHttp=new XMLHttpRequest();    }catch (e){ // Internet Explorer        try{            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");        }catch (e){            try{                xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");            }catch (e){                alert("\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301AJAX\uFF01");                return false;            }        }    }    if(ajaxCallBack==null || ajaxCallBack==""){        actionType=false;    }else{        actionType=true;    }    xmlHttp.open("POST",url,actionType);//false\u8868\u793A\u540C\u6B65,true\u8868\u793A\u5F02\u6B65    //xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");    //xmlHttp.setRequestHeader("Content-Length", parameter.length);    if(actionType){ //\u540C\u6B65\u65F6\u56DE\u8C03\u51FD\u6570	        //xmlHttp.onreadystatechange = eval(ajaxCallBack);        if (typeof(ajaxCallBack)=='string') {            xmlHttp.onreadystatechange=eval(ajaxCallBack);        }else{            xmlHttp.onreadystatechange=function(){                if (xmlHttp.readyState==4){                    ajaxCallBack(returntype=="XML"?xmlHttp.responseXML:returntype=="JSON"?eval("("+xmlHttp.responseText+")"):xmlHttp.responseText,xmlHttp);                }            }        }    }    xmlHttp.send(parameter);    if(actionType){        return false;//\u540C\u6B65\u65F6\u4E0D\u6267\u884C\u4EE5\u4E0B\u8FD4\u56DE\u5904\u7406    }    if(returntype=="XML"){        return xmlHttp.responseXML;    }else if(returntype=="JSON"){        return eval("("+xmlHttp.responseText+")");    }else{        tempstr=xmlHttp.responseText;        if(tempstr.indexOf("function")>=0){            alert("\u4F1A\u8BDD\u5DF2\u8D85\u65F6,\u8BF7\u91CD\u65B0\u767B\u5F55");            location.href=location.href;            return "OK";        }        if(tempstr.indexOf("Error\uFF1A")>=0){            //\u8FD4\u56DE\u7ED3\u679C\u7ED3\u679C\u5305\u542B\u63D0\u793A\u4FE1\u606F\u53CA\u8FD4\u56DE\u6B63\u786E\u5904\u7406\u7ED3\u679C\u65F6\u5219Error\uFF1A\u81F3OK\u4E3A\u9519\u8BEF\u63D0\u793A\u4FE1\u606F,OK\u540E\u4E3A\u8FD4\u56DE\u5904\u7406\u7ED3\u679C            if (tempstr.indexOf("OK\uFF1A")>=0){                Errstr=tempstr.substring(6,tempstr.indexOf("OK\uFF1A"));            }else{                Errstr=tempstr.substring(6,tempstr.length);            }            try{                Ext.MessageBox.alert('\u7CFB\u7EDF\u63D0\u793A',Errstr);            }catch(e){                alert(Errstr);            }            if (tempstr.indexOf("OK\uFF1A")>=0){                tempstr=tempstr.substring(tempstr.indexOf("OK\uFF1A")+3,tempstr.length)                return tempstr;            }else{                return "";            }        }else{            //\u5F53\u6267\u884C\u4EE3\u7406\u6CA1\u6709\u8FD4\u56DE\u4EFB\u4F55\u7ED3\u679C\u65F6\u4E3A\u4E86\u907F\u514D\u5728\u9519\u8BEF\u8FD4\u56DE\u7A7A\u65F6\u51B2\u7A81\u5219\u6267\u884C\u4EE3\u7406\u8FD4\u56DE\u7A7A\u65F6\u5219\u8FD4\u56DEOK            if (tempstr==""){                return "OK";            }else{                if (tempstr.indexOf("OK\uFF1A")>=0){                    tempstr=tempstr.substring(tempstr.indexOf("OK\uFF1A")+3,tempstr.length)                    return tempstr;                }else{                    return tempstr;                }            }        }    }} //*******************************************************////\u590D\u9009\u6846\u5168\u9009\u51FD\u6570//*******************************************************function SelectAll_Checkbox(checkbox){    var i;    for (i=0;i<checkbox.length;i++){        if (checkbox[i].checked == false){            checkbox[i].checked = true;        }    }}//*******************************************************//\u590D\u9009\u6846\u53D6\u6D88\u5168\u9009\u51FD\u6570//*******************************************************function DeSelectAll_Checkbox(checkbox){    var i;    for (i=0;i<checkbox.length;i++){        if (checkbox[i].checked == true){            checkbox[i].checked = false;        }    }}//\u53CD\u5411\u9009\u62E9function InvSelectAll_Checkbox(checkbox){    var i;    for (i=0;i<checkbox.length;i++){	        checkbox[i].checked = !checkbox[i].checked    }}//\u5C45\u4E2D\u6253\u5F00\u7A97\u53E3function openCenterWindowUrl(address,obj,widthx,hightx){    var windowhight = hightx;    var windowwidth = widthx;    var top = (window.screen.availHeight - windowhight)/2;    var left = (window.screen.availWidth - windowwidth)/2;    var	features = "scrollbars=1,status=no,toolbar=no,menubar=no,location=no,resizable=yes";    window.open(address,obj.replace(/[()]/g,""),'Height=' + windowhight + ',Left=' + left + ',Top='+ top +',Width=' + windowwidth + ',' + features);}function openCenterWindow(strWindowURL,obj,widthx,hightx){    showModalDialog(strWindowURL,obj.replace(/[()]/g,""), 'dialogWidth:' + widthx + 'px;dialogHeight:' + hightx + 'px;center:yes;help:no;resizable:no;status:no;scroll:no');	}function openWindow(address,obj,widthx,hightx){    var URL = address;    //showModalDialog(URL,obj, 'dialogWidth:'+widthx+'px;dialogHeight:'+hightx+'px;center:yes;help:no;resizable:no;status:no;scroll:no');      window.open(URL,'_blank',"Scrollbars=yes,Toolbar=no,Location=no,Direction=no,Resizable=yes,width=" + widthx +",height="+ hightx);}//\u6267\u884C\u68C0\u7D22function doSearch(SearchType){    var i = document.forms[0].selectvalue.selectedIndex;    var url;    if (document.forms[0].selectvalue.options(i).value == "\u5206\u9694\u7B26"){        alert("\u8BF7\u5148\u9009\u62E9\u8981\u5FEB\u901F\u641C\u7D22\u7684\u6A21\u5757!");        return false;    }    if (document.forms[0].selectvalue.options(i).value != "\u901A\u8BAF\u5F55")    {        if (document.forms[0].SearchKey.value == "")        {            alert("\u8BF7\u5148\u586B\u5199\u5FEB\u901F\u641C\u7D22\u5173\u952E\u5B57!");            return false;        }              	    }    if ((document.forms[0].selectvalue.options(i).value == "\u901A\u8BAF\u5F55") && SearchType =="1" )    {             url = "/" + DBDir + "/afhomepage.nsf/FrameAddressBook?OpenFrameSet";        url = url +"&SearchType=BYInputKey&SearchKey=" + window.document.forms[0].SearchKey.value;	         window.open(url,"Main")    }else    {        if (SearchType=="3")        {            url = "frmSearchList?OpenForm&SearchType="+SearchType+"&OptionValue="+window.document.forms[0].selectvalue.value+"&SearchKey=" + window.document.forms[0].SearchKey.value;            window.open(url)        }else        {            url = "frmSearch?OpenForm&SearchType="+SearchType+"&OptionValue="+window.document.forms[0].selectvalue.value+"&SearchKey=" + window.document.forms[0].SearchKey.value;            if (SearchType=="1")            {                window.open(url);			             }else            {                 window.open(url,"_self")            } 	         }    }}function OnTabChange(TabId,PanelId){    if(getElement("tab")==null){        return false;    }    if (getElement(TabId) == null) {        return false;    }    var TabIdText=getElement(TabId).innerText;    tabs=getElement("tab").getElementsByTagName("li");    for (i=0;i<tabs.length;i++){        if(tabs[i].id==TabId){            tabs[i].className="tab_sel";            getElement(PanelId).style.display='block';            if(TabId=="tabzw"){                if(iframezw.location.href=="about:blank"){                    url="/" +GetItemValue("SysDBPath")+ "/frmQxxxRead?openform";                    url=url+"&fldqxxxid=" + GetItemValue("fldqxxxid");                    url=url+"&flddbnameQxxx="+GetItemValue("DBDir")+"/"+GetItemValue("flddbnameQxxx");                    taskname=GetItemValue("fldtaskname");                    if (TabIdText.indexOf("\u5408\u540C")!=-1){                        if(GetItemValue("fldHasZSHT")!=""){                            url=url+"&doctype=zsht";                        }else{                            url=url+"&doctype=htmb";                        }                    }else{                        HasFawen=GetItemValue("fldHasFawen");                        if(HasFawen!=""){                            url=url+"&doctype="+escape(GetItemValue("fldTM",true));                        }else{                            url=url+"&doctype=caogao";                        }                    }                    //url=url+"&ADOCUNID=" + document.all.fldadocid.value +"&fldqxxxid=" + document.all.fldqxxxid.value;                    //url=url+"&MBMC=\u6B63\u5F0F\u53D1\u6587&Category=\u751F\u6210\u6B63\u5F0F\u6587\u4EF6&EditMode=0&FWGS=\u516C\u53F8\u53D1\u6587";                    iframezw.location.href=url;                }            }            else if (PanelId=="blgc" || PanelId=="blyj"){                getData(PanelId,false);            }        }else{            tabs[i].className="";            try{           	 if(TabId!="tabzw" & iframezw!=null){            		iframezw.location.href="about:blank"           	 }            }catch(e){}            getElement(tabs[i].getAttribute('text')).style.display="none";        }    }}function getData(PanelId,Isref){    if (PanelId=="blyj"){        PanelId="blyjbydept";    }    try{        if(PanelId=="blyjbydept"){            getElement("selectdept",true)[0].selected=true;            getElement("selecttime",true)[0].selected=true;        }        else{            getElement("selectdept",true)[1].selected=true;            getElement("selecttime",true)[1].selected=true;        }    }catch(e){}    if(getElement(PanelId).innerText==""){  //if(getElement(PanelId).innerHTML==""){        Isref=true;    }    if (Isref){        var fldbutton=""        if (getElement("fldbutton")!=null){            fldbutton = GetItemValue("fldbutton");        }        if(fldbutton == "\u9000\u51FA"){            var cdocid = GetItemValue("fldcdocid");            var url = "/" + DBPath + "/Agent_CheckYJDBList?OpenAgent";            var parameter = "&cdocid=" + cdocid;            var tempstr = ajaxFunction(url,parameter).trim();            if(tempstr.indexOf("more")>=0){                var pathlist = tempstr.split("-");                getElement('yjdbpath').innerText=pathlist[1];                var url = "/" + SysDBPath + "/frmButtonMenu?openform&ChooseType=1&queryopenflag=false" + "&pathlist=true";                OpenExtWindow("extwin",url,"\u8BF7\u9009\u62E9\u8981\u67E5\u770B\u610F\u89C1\u7684\u5355\u4F4D\u6216\u90E8\u95E8\uFF01",500,338,"ab","getdatalist('"+PanelId+"')");            }else if(tempstr.indexOf("one")>=0){                try{                    getElement('yjdbpath').innerText = tempstr.split("-")[1];                }catch(e){}                getdatalist(PanelId)            }else{                if(PanelId=="blyjbydept"){                    getElement(PanelId).style.display='block';                    getElement(PanelId).innerHTML="\u6CA1\u6709\u53EF\u67E5\u770B\u7684\u610F\u89C1\u4FE1\u606F\uFF01";                }else{                    getElement(PanelId).innerHTML="\u6CA1\u6709\u53EF\u67E5\u770B\u7684\u529E\u7406\u8FC7\u7A0B\u4FE1\u606F\uFF01";                }            }        }else{            getdatalist(PanelId)        }    }    if (PanelId=="blyjbytime"){        getElement(PanelId).style.display="block";        getElement("blyjbydept").style.display="none";    }    if (PanelId=="blyjbydept"){        getElement(PanelId).style.display="block";        getElement("blyjbytime").style.display="none";    }}function getdatalist(PanelId){    if(PanelId=="blgc"){        if (getElement("flddbnameflowlog")!=null){            var dbname=GetItemValue("flddbnameflowlog");        }    }else{        if (getElement("flddbnameflowlog")!=null){            var dbname=GetItemValue("flddbnameyj");        }    }    var yjdbpath="";    try{        if(getElement('yjdbpath').innerText.trim()!=""){            yjdbpath=escape(getElement('yjdbpath').innerText+dbname);        }    }catch(e){}    var url="/"+SysDBPath+"/AgentOnChangeTab?openagent";    var parameter="&fldadocid="+GetItemValue("fldadocid")+"&fldcdocid="+GetItemValue("fldcdocid");    parameter=parameter+"&CdocDBPath="+GetItemValue("DBPath")+"&yjdbpath="+yjdbpath;    parameter=parameter+"&ctype="+PanelId;    var tempstr=ajaxFunction(url,parameter);    if(tempstr=="OK"){        return false;    }    try{        getElement(PanelId).innerHTML=tempstr;    }catch(e){        alert("\u8FDE\u63A5\u8D85\u65F6\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55\uFF01");        location.reload();        return false;    }}function ShowMenu(MenuID,Flagx){    //\u8BBE\u7F6E\u83DC\u5355\u9879\u662F\u5426\u9690\u85CF\uFF0CMenuID:\u83DC\u5355ID,Flagx:1\u4E3A\u663E\u793A\uFF0C0\u4E3A\u9690\u85CF    var Menux = getElement(MenuID);    if (Menux != null){        if (Flagx == "1"){            Menux.style.display = "";        }else{            Menux.style.display = "none";        }    }}function GetXmlNodeValue(xmlDoc,NodeName){    //\u53D6\u5F97XML\u8282\u70B9\u503C\u51FD\u6570    var Obj = xmlDoc.getElementsByTagName(NodeName);    return Obj[0].getAttribute('text');}//\u8868\u5355\u57DF\u503C\u662F\u5426\u6539\u53D8function IsFormChanged() {      var isChanged = false;      var form = document.forms[0];      for (var i = 0; i < form.elements.length; i++) {          var element = form.elements[i];          var type = element.type;          if (type == "text" || type == "hidden" || type == "textarea" || type == "button") {              if (element.value != element.defaultValue && element.name != "ActionName") {                isChanged = true;                  break;              }          } else if (type == "radio" || type == "checkbox") {              if (element.checked != element.defaultChecked) {                  isChanged = true;                  // alert("2:"+element.name)                  break;              }          } else if (type == "select-one"|| type == "select-multiple") {              for (var j = 0; j < element.options.length; j++) {                  if (element.options[j].selected != element.options[j].defaultSelected) {                      isChanged = true;                      //alert("3:"+element.name)                      break;                  }              }          } else {               //  etc...          }             }     //alert( isChanged?"\u4F60\u6539\u53D8\u4E86\u8868\u5355\u7684\u9ED8\u8BA4\u503C.":"\u6210\u529F\u63D0\u4EA4.");      return isChanged;  }//\u8FD0\u8F6C\u72B6\u6001\u7A97\u53E3function OpenYZZTWindow(panelitems,ID,Title,widthx,heightx){    var iframeid = "";    var OpenDocUrl="";    nrheight=heightx-80;//\u91CC\u9762Tab\u5185\u5BB9\u9AD8\u5EA6    yjheight=nrheight-3;//\u610F\u89C1DIV\u7684\u9AD8\u5EA6    var win = new Ext.Window({        id		: ID,        title		: Title,        width		: widthx,        height		: heightx,        autoDestroy	: true,        closable	: true,        modal		: true,        plain		: true,        resizable 	: false    });    tabs=new Ext.TabPanel({        activeTab:0,        border:false,                      enableTabScroll:true    })    //\u589E\u52A0Tab    if(panelitems!=""){        var urllen=panelitems.indexOf("OpenDocUrl");//\u83B7\u53D6\u6253\u5F00\u6587\u6863\u7684URL        if (urllen!=-1){            var items=panelitems.substring(urllen,panelitems.length);            panelitems=panelitems.substring(0,urllen-1);            items=items.split("$");            OpenDocUrl=items[2];            fldadocid=items[1];        }        panelitems=panelitems.split(",");        for (i=0;i<panelitems.length;i++){            var items=panelitems[i].split("$");            if (items[0]=="\u529E\u7406\u610F\u89C1"){                var panel=new Ext.Panel({                    title: items[0],                    id: items[1],                    width	: 680,                    height	: nrheight,                    listeners:{                        activate:function(){                            items0=panelitems[0].split("$");                            var iframex = GetIframeObj("","iframe_"+items0[1]);                            getElement("yjlist").innerHTML=iframex.GetItemValue("fldyijianlist");                        }                    },                    html:'<div class="list_box" id="yjlist" style="height:'+yjheight+'px; overflow-y: auto;font-size:12px"></div>'                });            }else{                iframeid="iframe_" + items[1];                var panel=new Ext.Panel({                    title: items[0],                    id: items[1],                    width	: 680,                    height	: nrheight,                    html:'<iframe name="' + iframeid + '" id="' + iframeid + '" src="'+ items[2] +'" width="100%" marginwidth="0" height="100%" marginheight="0" scrolling="no" frameborder="0"></iframe>'                });            }            tabs.add(panel);        }        if(OpenDocUrl!=""){            win.addButton({text:'\u76F4\u63A5\u6253\u5F00\u6587\u4EF6'},function(){                openDocByYZZT(OpenDocUrl,fldadocid);            });        }        win.addButton({text:'\u786E\u5B9A'},function(){            for (i=0;i<panelitems.length;i++){                var items=panelitems[i].split("$");                if (items[0]!="\u529E\u7406\u610F\u89C1"&&items[0]!="\u8FD0\u8F6C\u65E5\u5FD7"){                    iframeid="iframe_" + items[1];                    var iframex =GetIframeObj("",iframeid);                    if (iframex!=null){                        iframex.ReturnValue();                    }                }            }        });        win.addButton({text:'\u53D6\u6D88'},function(){            win.close();        });        win.add(tabs);        win.on("beforeclose",function(){            for (i=0;i<panelitems.length;i++){                var items=panelitems[i].split("$");                if (items[0]!="\u529E\u7406\u610F\u89C1"){                    var items=panelitems[i].split("$");                    iframeid="iframe_" + items[1];                    closewin(iframeid);                }            }        })        win.show();    }}//\u83B7\u53D6\u4FEE\u6539\u7684\u57DF\uFF0C\u7528\u4E8E\u70B9\u51FB\u53D1\u9001\u6309\u94AE\u524D\u4FEE\u6539\u4E86\u4E3B\u6587\u6863function GetChangedItems() {    var changeditem = "";    var isChanged = false;    var form = document.forms[0];    for (var i = 0; i < form.elements.length; i++) {        isChanged = false;        var element = form.elements[i];        var type = element.type;          if (type == "text" || type == "textarea") {            if (element.value != element.defaultValue) {                isChanged = true;            }          } else if (type == "radio" || type == "checkbox") {            if (element.checked != element.defaultChecked) {                isChanged = true;            }          }        if(isChanged == true){            if(changeditem == ""){                changeditem = element.name;            }else{                changeditem = changeditem + ";" + element.name;            }        }	    }     return changeditem;  }//\u7528\u4E00\u822C\u7A97\u53E3\u65B9\u5F0F\u6253\u5F00\u5168\u606F\u4FE1\u606FNTKO\u63A7\u4EF6\u8868\u5355function openQxxxNTKOWindow2(address){    var windowwidth = screen.availWidth-100;	//890;    var windowhight = screen.availHeight;    var features = "scroll=no;status=no;resizable=yes;center=yes;";    var UNID = GetItemValue("fldcdocid");    address = address + "&WindowType=Normal";    openCenterWindowUrl(address,UNID,windowwidth,windowhight);}//\u7528\u6A21\u5F0F\u7A97\u53E3\u65B9\u5F0F\u6253\u5F00\u5168\u606F\u4FE1\u606FNTKO\u63A7\u4EF6\u8868\u5355function openQxxxNTKOWindow(address){    var windowwidth = screen.availWidth-100;	//890;    var windowhight = screen.availHeight;    var features = "scroll=no;status=no;resizable=yes;center=yes;minimize=yes;maximize=yes;";    showModalDialog(address,window,'dialogWidth:' + windowwidth + 'px;dialogHeight:' + windowhight + 'px;' + features);}//\u8FD0\u8F6C\u7A97\u53E3\u4E2D\u7528\u4E00\u822C\u7A97\u53E3\u65B9\u5F0F\u6253\u5F00CDOC\u6587\u6863\u8868\u5355function openDocByYZZT(address,ID){    var hightx = screen.availHeight - 100;    var widthx = 850;    var top = (window.screen.availHeight - hightx)/2;    var left = (window.screen.availWidth - widthx)/2;    var features = 'Height=' + hightx + ',Left=' + left + ',Top='+ top +',Width=' + widthx + ',' + "scrollbars=1,status=yes,toolbar=no,menubar=no,location=no,resizable=yes";    address += "&TabID=" + ID;    window.open(address,ID, features);}function SelectTreeView(conf){    //\u901A\u8FC7ext\u6811\u5F62\u5217\u51FA\u89C6\u56FE\u4E0A\u9762\u7684\u6587\u6863\u6765\u9009\u62E9,\u76F4\u63A5\u628A\u9009\u62E9\u5230\u7684\u503C\u5199\u5230\u57DF\u91CC\u9762\u6216\u8005\u8FD4\u56DE\u5230\u56DE\u8C03\u51FD\u6570    //conf\u914D\u7F6E\u9879\u6709\uFF1A    //conf.viewname:\u89C6\u56FE\u540D\u5B57    //conf.appdbpath:\u89C6\u56FE\u6240\u5728\u89C6\u56FE\u5E93\u540D\uFF0C\u6CA1\u4F20\u5F53\u6210\u662F\u7CFB\u7EDF\u8BBE\u7F6E\u5E93    //conf.searchkey:\u89C6\u56FE\u68C0\u7D22\u7528\u7684key,\u53EF\u7528\u6765\u53EA\u663E\u793A\u4E00\u4E2A\u5206\u7C7B\u6765\u9009\u62E9    //conf.itemname:\u89C6\u56FE\u4E0A\u7684\u6587\u6863\u663E\u793A\u7684\u503C\uFF0C\u516C\u5F0F    //conf.ChooseType:\u5355\u9009\u6216\u8005\u591A\u9009\uFF0C1\u5355\u9009,2\u591A\u9009    //conf.datafields:\u8FD4\u56DE\u7684\u9009\u62E9\u5230\u7684\u503C\u3002\u516C\u5F0F    //conf.ItemValues:\u5DF2\u9009\u62E9\u5230\u7684\u503C\uFF0C\u5BF9\u591A\u9009\u624D\u53EF\u7528\uFF0C\u591A\u503C\u7528","\u5206\u5F00\uFF0C\u5BF9\u5E94items\u503C\u7528"#"\u5206\u5F00    //conf.items:\u8FD4\u56DE\u7684\u76F4\u63A5\u5199\u5165\u7684\u8868\u5355\u57DF\uFF0C\u591A\u503C\u7528"|"\u5206\u5F00\uFF0C\u5BF9\u5E94datafields\u503C\u7528"#"\u5206\u5F00    //conf.returniframe:\u57DFitems\u5BF9\u5E94\u7684\u8868\u5355\u6240\u5728\u7684iframeid    //conf.title:\u5BF9\u8BDD\u6846\u6807\u9898    //conf.fn:\u56DE\u8C03\u51FD\u6570\uFF0C\u6240\u9009\u62E9\u5230\u6211\u503C\u4F1A\u5F53\u6210\u4E00\u4E2A\u6570\u7EC4\u4F1A\u4E3A\u6B64\u51FD\u6570\u7684\u53C2\u6570\u6765\u8C03\u7528\u6B64\u51FD\u6570    //conf.width:\u5BF9\u8BDD\u6846\u7684\u5BBD    //conf.heigth:\u9AD8    var url='/' + SysDBPath + '/frmSelectTreeNode?openForm'+        '&viewname='+encodeURIComponent(conf.viewname)+        '&itemname='+encodeURIComponent(conf.itemname)+        '&datafields='+encodeURIComponent(conf.datafields)+        '&ChooseType='+conf.ChooseType+        (conf.searchkey?"&searchkey="+encodeURIComponent(conf.searchkey):"")+        (conf.items?"&items="+conf.items:"")+        (conf.appdbpath?"&appdbpath="+conf.appdbpath:"")+        (conf.returniframe?"&returniframe="+conf.returniframe:"")+        (conf.ChooseType=="2"?"&ItemValues="+conf.ItemValues:"");    var title=conf.title||"\u8BF7\u9009\u62E9";    var h=conf.heigth||320;    var w=conf.width||480;    if (window.Ext){        OpenExtWindow('treewin',url,title,w,h,(conf.buttons||"ab"),conf.fn);    }else{        if (!conf.returniframe && conf.items){url+="&returniframe=iframe" + parent.Ext.WindowMgr.getActive().getId()}        parent.OpenExtWindow('treewin',url,title,w,h,(conf.buttons||"ab"),conf.fn);    }}function SetReturnValue(pdoc,items,value_str,append){    //\u8BBE\u7F6Epdoc\u4E0A\u9762\u7684\u57DFitems,items\u7528,\u53F7\u5206\u5F00\uFF0Cvalue_str\u7528#\u53F7\u5206\u5F00.    if (!items){return;}    if (value_str==undefined) {return;}    var item = items.split("|");    var value =item[1]? value_str.split("#"):[value_str]; //\u5F53\u53EA\u4F20\u5165\u4E00\u4E2A\u57DF\u503C\u7684\u65F6\u5019\uFF0Cvalue\u4E5F\u6CA1\u5FC5\u8981\u7528"#"\u5206\u5F00    var tempvalue="";    for(var j=0; j<item.length; j++){    	   var itemobj = pdoc.getElementById(item[j]);    	   if(itemobj==null){			itemobj = pdoc.getElementsByName(item[j])[0];	   }        if (itemobj){            if(itemobj.value != undefined){                if (append && itemobj.value!==""){                   itemobj.value = itemobj.value+ append + value[j];                }else{                                itemobj.value = value[j];                }                            }else{                if (append && itemobj.innerText!==""){                    itemobj.innerText =itemobj.innerText+append+value[j];                }else{                    itemobj.innerText = value[j];                }            }        }    }}function SelectBLRY(bmcode, ChooseType, clearbutton, datafields, callback,ItemValues) {    //\u6807\u51C6\u9009\u62E9\u529E\u7406\u4EBA\u5458\u51FD\u6570\uFF0Cbmcode\u7528\u4E8E\u4F20\u5165\u53EF\u5148\u7684\u673A\u6784\u6216\u8005\u90E8\u95E8\u7684\u7F16\u53F7\uFF0C\u591A\u503C\u7528|\u5206\u5F00,"all"\u8868\u793A\u6240\u6709\u673A\u6784\uFF0C\u6CA1\u4F20\u8868\u793A\u5F53\u524D\u7528\u6237\u6240\u5728\u7684\u673A\u6784    //clearbutton\u4E3Atrue\u65F6\u4E3A\u6709\u6E05\u7A7A\u6309\u94AE    //datafields\u662F\u4EBA\u5458\u6587\u6863\u8FD4\u56DE\u7684\u503C\uFF0C\u516C\u5F0F    //ChooseType\u6307\u5B9A\u7528\u5355\u9009("1")\u6216\u8005\u591A\u9009("2"),callback\u53EF\u4EE5\u662F\u56DE\u8C03\u51FD\u6570\uFF0C\u4E5F\u53EF\u4EE5\u662F\u8981\u8FD4\u56DE\u503C\u7684\u57DF    //ItemValus\u662F\u5DF2\u9009\u62E9\u7684\u503C\uFF0C\u5BF9\u591A\u9009\u624D\u53EF\u7528    var url = '/' + SysDBPath + '/frmSelectBLRY?openForm&ChooseType=' + ChooseType + (bmcode?"&TaskGroupCode=" + bmcode:"") + (datafields?"&datafields="+encodeURIComponent(datafields):"");    var url = url + "&ItemValues="+ItemValues;    var fn = function(v, menuid) {        if (menuid === "a") {            //\u70B9\u51FB\u7684\u662F\u5B8C\u6210            if (typeof(callback) !== "function") {                for (var i = 0; i < v.length; i++) {                    SetReturnValue(document, callback, v[i], ChooseType==="2"?",":"")                }            } else {                callback.call(null, v, "a")            }        } else {            //\u6E05\u7A7A\u7684\u65F6\u5019            if (typeof(callback) !== "function") {                var item = callback.split("|");                for (var i = 0; i < item.length; i++) {                    var o = getElement(item[i]);                    if (o.value == null) {                        o.innerText = "";                    } else {                        o.value = "";                    }                }            } else {                callback.call(null, v, "e");            }        }    }	    var button = clearbutton ? "abe": "ab";    if (window.Ext){        OpenExtWindow('treewin', url, '\u9009\u62E9\u4EBA\u5458', 490, 320, button, fn);    }else{        parent.OpenExtWindow('treewin', url, '\u9009\u62E9\u4EBA\u5458', 490, 320, button, fn);    }}function SelectPeople(iframe, item, bmcode, selecttype, sourceType, clearbutton, datafields, callback) {    //table\u65B9\u5F0F\u9009\u62E9\u4EBA\u5458\u51FD\u6570    //iframe\uFF0Citem\u7528\u4E8E\u53D6\u5F97\u5DF2\u6709\u7684\u503C\u7684iframe,\u57DF\u540D;\u6E05\u7A7A\u65F6\u4E5F\u4F1A\u7528\u5230.item\u591A\u503C\u7528|\u5206\u5F00\uFF0Citem\u91CC\u7684\u7B2C\u4E00\u4E2A\u57DF\u7684\u503C\u7528\u4E8E\u663E\u793A    //bmcode\u7528\u4E8E\u4F20\u5165\u53EF\u5148\u7684\u673A\u6784\u6216\u8005\u90E8\u95E8\u7684\u7F16\u53F7\uFF0C\u591A\u503C\u7528|\u5206\u5F00,"all"\u8868\u793A\u6240\u6709\u673A\u6784\uFF0C\u6CA1\u4F20\u8868\u793A\u5F53\u524D\u7528\u6237\u6240\u5728\u7684\u673A\u6784    //clearbutton\u4E3Atrue\u65F6\u4E3A\u6709\u6E05\u7A7A\u6309\u94AE    //sourceType\uFF1A1\u8868\u793A\u9009\u62E9\u7528\u6237\uFF0C\u5176\u4ED6\u8868\u793A\u9009\u62E9\u529E\u7406\u4EBA\u5458    //datafields\u662F\u4EBA\u5458\u6587\u6863\u8FD4\u56DE\u7684\u503C\uFF0C\u516C\u5F0F    //selecttype\u6307\u5B9A\u7528\u5355\u9009("1")\u6216\u8005\u591A\u9009("2"),callback\u53EF\u4EE5\u662F\u56DE\u8C03\u51FD\u6570\uFF0C\u4E5F\u53EF\u4EE5\u662F\u8981\u8FD4\u56DE\u503C\u7684\u57DF    var url = '/' + SysDBPath + '/frmSelectPeople?openForm&selecttype=' + selecttype + (bmcode?"&bmcode=" + bmcode:"") + (datafields?"&datafields="+encodeURIComponent(datafields):"");    url = url + (iframe?"&returniframe=" + iframe:"") + (item?"&item=" + item:"") + (sourceType?"&sourceType=" + sourceType:"")    var fn = function(v, menuid) {        if (menuid === "a") {            //\u70B9\u51FB\u7684\u662F\u5B8C\u6210            if (typeof(callback) !== "function") {                var item = callback.split("|");                for (var i = 0; i < item.length; i++) {                    var o = getElement(item[i]);                    if (o.value == null) {                        o.innerText = "";                    } else {                        o.value = "";                    }                }                for (var i = 0; i < v.length; i++) {                    SetReturnValue(document, callback, v[i], selecttype==="2"?",":"")                }            } else {                callback.call(null, v, "a")            }        } else {            //\u6E05\u7A7A\u7684\u65F6\u5019            if (typeof(callback) !== "function") {                var item = callback.split("|");                for (var i = 0; i < item.length; i++) {                    var o = getElement(item[i]);                    if (o.value == null) {                        o.innerText = "";                    } else {                        o.value = "";                    }                }            } else {                callback.call(null, v, "e");            }        }    }	    var button = clearbutton ? "abe": "ab";    if (window.Ext){        OpenExtWindow('selectpeople', url, '\u9009\u62E9\u4EBA\u5458', 654, 457, button, fn);    }else{        parent.OpenExtWindow('selectpeople', url, '\u9009\u62E9\u4EBA\u5458', 654, 457, button, fn);    }}function SelectPeopleAndGroup(iframe, item, bmcode, selecttype, sourceType, clearbutton, datafields, callback) {    //table\u65B9\u5F0F\u9009\u62E9\u4EBA\u5458\u51FD\u6570    //iframe\uFF0Citem\u7528\u4E8E\u53D6\u5F97\u5DF2\u6709\u7684\u503C\u7684iframe,\u57DF\u540D;\u6E05\u7A7A\u65F6\u4E5F\u4F1A\u7528\u5230.item\u591A\u503C\u7528|\u5206\u5F00\uFF0Citem\u91CC\u7684\u7B2C\u4E00\u4E2A\u57DF\u7684\u503C\u7528\u4E8E\u663E\u793A    //bmcode\u7528\u4E8E\u4F20\u5165\u53EF\u5148\u7684\u673A\u6784\u6216\u8005\u90E8\u95E8\u7684\u7F16\u53F7\uFF0C\u591A\u503C\u7528|\u5206\u5F00,"all"\u8868\u793A\u6240\u6709\u673A\u6784\uFF0C\u6CA1\u4F20\u8868\u793A\u5F53\u524D\u7528\u6237\u6240\u5728\u7684\u673A\u6784    //clearbutton\u4E3Atrue\u65F6\u4E3A\u6709\u6E05\u7A7A\u6309\u94AE    //sourceType\uFF1A1\u8868\u793A\u9009\u62E9\u7528\u6237\uFF0C\u5176\u4ED6\u8868\u793A\u9009\u62E9\u529E\u7406\u4EBA\u5458    //datafields\u662F\u4EBA\u5458\u6587\u6863\u8FD4\u56DE\u7684\u503C\uFF0C\u516C\u5F0F    //selecttype\u6307\u5B9A\u7528\u5355\u9009("1")\u6216\u8005\u591A\u9009("2"),callback\u53EF\u4EE5\u662F\u56DE\u8C03\u51FD\u6570\uFF0C\u4E5F\u53EF\u4EE5\u662F\u8981\u8FD4\u56DE\u503C\u7684\u57DF    var url = '/' + SysDBPath + '/frmSelectPeopleAndGroup?openForm&selecttype=' + selecttype + (bmcode?"&bmcode=" + bmcode:"") + (datafields?"&datafields="+encodeURIComponent(datafields):"");    url = url + (iframe?"&returniframe=" + iframe:"") + (item?"&item=" + item:"") + (sourceType?"&sourceType=" + sourceType:"")    var fn = function(v, menuid) {        if (menuid === "a") {            //\u70B9\u51FB\u7684\u662F\u5B8C\u6210            if (typeof(callback) !== "function") {             	var item = callback.split("|");                for (var i = 0; i < item.length; i++) {                    var o = getElement(item[i]);                    if (o.value == null) {                        o.innerText = "";                    } else {                        o.value = "";                    }                }                for (var i = 0; i < v.length; i++) {                    SetReturnValue(document, callback, v[i], selecttype==="2"?",":"")                }            } else {                callback.call(null, v, "a")            }        } else {            //\u6E05\u7A7A\u7684\u65F6\u5019            if (typeof(callback) !== "function") {                var item = callback.split("|");                for (var i = 0; i < item.length; i++) {                    var o = getElement(item[i]);                    if (o.value == null) {                        o.innerText = "";                    } else {                        o.value = "";                    }                }            } else {                callback.call(null, v, "e");            }        }    }	    var button = clearbutton ? "abe": "ab";    if (window.Ext){        OpenExtWindow('selectpeople', url, '\u9009\u62E9\u4EBA\u5458', 654, 457, button, fn);    }else{        parent.OpenExtWindow('selectpeople', url, '\u9009\u62E9\u4EBA\u5458', 654, 457, button, fn);    }}function SelectBLBM(jgcode,ChooseType,clearbutton,datafields,callback){    SelectTreeView({        viewname:"v_Sort_frmBLBM",        datafields:datafields,        ChooseType:ChooseType,        itemname:"fldBMMC",		        searchkey:jgcode,        buttons:clearbutton?"abe":"ab",        fn:(typeof(callback)==="function"?callback:undefined),        items:(typeof(callback)!=="function"?callback:undefined),        ItemValues:(typeof(callback)!=="function"?GetItemValue(callback):undefined)    })}function DbLookup(dbName,viewName,keyWord,fileName){	var url="/"+SysDBPath+"/Agent_DBLookup?openagent";	var parameter="&dbName="+escape(dbName)+"&viewName="+escape(viewName)+"&keyWord="+escape(keyWord)+"&fileName="+fileName;	var tempstr=ajaxFunction(url,parameter)	if(tempstr!="OK"){		return eval(tempstr);	}}function DbColumn(dbName,viewName,columnNumber){	var url="/"+SysDBPath+"/Agent_DBLookup?openagent";	var parameter="&dbName="+escape(dbName)+"&viewName="+escape(viewName)+"&columnNumber="+columnNumber;	var tempstr=ajaxFunction(url,parameter)	if(tempstr!="OK"){		return eval(tempstr);	}}function ListBox(cfg) {    var data = cfg.data;    var title = cfg.title || "\u8BF7\u9009\u62E9:";    var width = cfg.width || 300;    var height = cfg.height || 300;    var url = cfg.url;    var params = cfg.params;    var CallBack = cfg.fn;    var curitem = Ext.isArray(cfg.curitem) ? cfg.curitem: [cfg.curitem];    var myCheckboxItems = [];    var multi = cfg.multi    if (url && ! data) {        //\u901A\u8FC7URL\u6765\u53D6\u503C        Ext.Ajax.request({            url: url,            success: function(v) {                try{                    cfg.data = Ext.decode(v.responseText);                    ListBox(cfg)                }catch(e){alert("\u8FD4\u56DE\u6570\u636E\u9519\u8BEF:\n" + v.responseText)}            },            failure: function(v) {                Ext.Msg.alert("\u8C03\u7528Ajax\u51FA\u9519:", v.responseText)            },            params: cfg.params        });        return;    }    if (!data) return;    for (var i = 0; i < data.length; i++) {        var index = data[i].indexOf("|");        var boxLabel = index === - 1 ? data[i] : data[i].slice(0, index);        var name = index === - 1 ? data[i] : data[i].slice(index + 1);        myCheckboxItems.push({            boxLabel: boxLabel,            name: "it",            inputValue: name,            checked: curitem.indexOf(name) !== - 1        });    }    var form = new Ext.FormPanel({        layout: 'column',        autoScroll:true,        items: [{            xtype: multi ? "checkboxgroup": "radiogroup",            columns: 1,            items: myCheckboxItems        }]    });    var win = new Ext.Window({        modal: true,        layout: 'fit',        title: title,        width: width,        height: height,        plain: true,        items: [form],        buttons: [{            xtype: 'button',            text: '\u786E\u5B9A',            handler: function() {                if (multi) {                    var ids = [];                    var cbitems = form.get(0).items;                    for (var i = 0; i < cbitems.length; i++) {                        if (cbitems.itemAt(i).checked) {                            ids.push(cbitems.itemAt(i).inputValue);                        }                    }                } else {                    var ids = form.get(0).getValue().inputValue;                }                win.destroy();                if (Ext.isFunction(CallBack)) {                    CallBack.call(null, ids);                } else {                    return ids;                }            }        },        {            xtype: 'button',            text: '\u53D6\u6D88',            handler: function() {                win.destroy();            }        }]    });    win.show();}function NotesName(name){    var vnt=name.split("/");    var getFullName=function(){        if (name.indexOf("CN=")!==-1){            return name;        }else{            var tmpname;            for(var i=0;i<vnt.lenght;i++){                tmpname+=i==0?"CN=":i==vnt.lentht?"O=":"OU=" + vnt[i];            }            return tmpname;        }    }    this.FullName=getFullName;    this.cn=function(){return vnt[0].replace("CN=","");}    this.abb=function(){        if (name.indexOf("CN=")==-1){            return name;        }else{            return name.replace(/(^CN=)|(OU=)|(O=)/g,"")        }    }}//\u6807\u8BB0\u5DF2\u8BFBfunction MarkRead(appdbpath,appdocid){    var url="/" +SysDBPath + "/AgentSet_MailDocReadStatus?openagent"    var Parameter = "&ReadMode=read&DBPath=" +appdbpath+ "&UNID=" + appdocid;    ajaxFunction(url, Parameter);}//\u83B7\u53D6\u8868\u5355\u4E0A\u5BF9\u50CFfunction getElement(itemName,retEls){    //itemname:\u662F\u5BF9\u50CF\u7684ID\u6216Name    //retEls:True\u8FD4\u56DE\u5BF9\u50CF\u6570\u7EC4    if(!itemName)return null;    var el=document.getElementById(itemName);    if (el && !retEls){        return el;    }else{        var els=document.getElementsByName(itemName);        return els?(retEls?els:els[0]) : null;    }}function getIframeLocation(iframe){    /*iframe\u5BF9\u8C61\u91CC\u9762\u7684Location\u5C5E\u6027\uFF0C\uFF29\uFF25\u548Cchrome\u53D6\u6CD5\u4E0D\u540C*/    return iframe.location?iframe.location:iframe.ownerDocument?iframe.ownerDocument.location : null;}//\u81EA\u5B9A\u4E49\u9009\u62E9\u5BF9\u8BDD\u6846function SelectButtonHandler(obj){    var actions=eval("("+obj.getAttribute("actions")+")");    var TargetDomain=actions.TargetDomain;    var dataField;    if (actions.dataField) {        var dataField=Ext.util.Format.htmlDecode(actions.dataField);    }    var multiple=actions.multiple || "1";    if(actions.selType=="SelBLRY"){        if (!dataField) { dataField="@name([cn];fldLoginID)"; }        SelectBLRY('all',multiple, true, dataField,TargetDomain);    }else if(actions.selType=="SelBLBM"){        if (!dataField) { dataField="fldBMMC"; }        SelectBLBM('',multiple,true,dataField,TargetDomain)    }else if(actions.selType=="ModuleValues"){        selectProfileList({            appName:actions.AppName,            multi:multiple=="2",            keyName:actions.ItemName,            curitem:GetItemValue(TargetDomain),            fn:function(v){                SetItemValue(TargetDomain,Ext.isArray(v)?v.join(","):v);            }        });    }else if(actions.selType=="UserJS"){        var fn=eval("(function(){return "+Ext.util.Format.htmlDecode(actions.JSFunction)+"})()");        fn.call();    }}function getOptionText(op){    return op.text!==undefined?op.text:op.textContent    //if (op.text!==undefined){return op.text}else{return op.textContent}    //return op.text || op.textContent;}function getProfileList(appName,jgCode,keyName,fn){    /*\u53D6\u5F97profileList\u91CC\u9762\u7684\u503C.\u8FD4\u56DE\u5230\u5904\u7406\u51FD\u6570fn\u91CC\u9762*/    var url="/" + SysDBPath + "/AgentGet_ProfileList?OpenAgent";    var params="&appName=" + escape(appName) + "&jgCode=" + escape(jgCode) + "&keyName=" + escape(keyName);    ajaxFunction(url,params,"",function(text){        var obj=eval("("+text+")");        fn.call(window,obj.data||obj.errorMsg,obj.success);    });	}function selectProfileList(config){    getProfileList(config.appName, config.jgCode, config.keyName, function(data, success){        if (!success) {            Ext.Msg.alert("\u63D0\u793A", data);        }        else{            if(data.join(",").indexOf("treejson")!=-1){                var treejson=eval("("+data.join(",")+")");                var treeconfig={title:"\u8BF7\u9009\u62E9"+config.keyName,ChooseOnlyChildren:treejson.ChooseOnlyChildren,ChooseType:treejson.ChooseType,treejson:treejson.treejson,fn:config.fn}                treeBox(treeconfig)            }            else{                ListBox(Ext.applyIf({                    data:data,                    title:"\u8BF7\u9009\u62E9"+config.keyName,                    multi:config.multi,                    fn:function(v){                        config.fn.apply(null, arguments);                    }                }                , config));            }        }    }    );}function treeBox(config){    var width=config.width||550;    var height=config.height||350;    var CallBack=config.fn;    var ChooseOnlyChildren=true;    if(config.ChooseOnlyChildren!=null){        ChooseOnlyChildren=config.ChooseOnlyChildren;    }    var ChooseType=config.ChooseType||"2"    var extAttr=function(treejson){        Ext.each(treejson, function(obj){            obj.leaf=!obj.children;            obj.id=obj.id||obj.text;            if(ChooseOnlyChildren && !obj.children){			if(ChooseType=="2")obj.checked=false;		  }else if(ChooseOnlyChildren==false){               if(ChooseType=="2")obj.checked=false;		  }            if (obj.children) {                extAttr(obj.children)            }        }        );        return treejson;    };    var treejson=extAttr(config.treejson);    var tree=new Ext.tree.TreePanel({        //width: width,        //height: height,        autoScroll:true,        rootVisible: false,        root: new Ext.tree.AsyncTreeNode({            expand:true, children:treejson        }        )    }    );    var win = new Ext.Window({        width: width,        height: height,        layout: 'fit',        title:config.title||"\u8BF7\u9009\u62E9",        items: tree,        buttons: [{            xtype: 'button',            text: '\u786E\u5B9A',            handler: function() {                var values = [];                var nodes=[];                			if(ChooseType=="2"){				var selNodes = tree.getChecked();				if(selNodes.length!=0){                		Ext.each(selNodes, function(node){			     		attr = node.attributes.id;			     		nodes.push(node.getPath("id").right(tree.root.getPath("id")));                    		values.push(attr);               		}               		);               	}else{						Ext.Msg.alert('\u7CFB\u7EDF\u63D0\u793A', '\u8BF7\u9009\u62E9\u5B50\u8282\u70B9\uFF01');						return false;				}			}else{				if(ChooseOnlyChildren){					var node = tree.getSelectionModel().getSelectedNode();					if(node.leaf==true){					     nodes.push(node.getPath("id").right(tree.root.getPath("id")));			     		attr = node.attributes.id;                    		values.push(attr);                    	}else{						Ext.Msg.alert('\u7CFB\u7EDF\u63D0\u793A', '\u8BF7\u9009\u62E9\u5B50\u8282\u70B9\uFF01');						return false;					}				}else{                    	var node = tree.getSelectionModel().getSelectedNode();                    	nodes.push(node.getPath("id").right(tree.root.getPath("id")));			     	attr = node.attributes.id;                    	values.push(attr);				}			}                win.destroy();                                if (Ext.isFunction(CallBack)) {                    CallBack.call(null, values,nodes);                }                else {                    return values;                }            }        }        ,        {            xtype: 'button',            text: '\u53D6\u6D88',            handler: function() {                win.destroy();            }        }        ]    }    );    win.show();}function removeTabFromIframe(tabId){    /*\u7528\u4E8EExtTabWindow\u4E2D\u7684iframe\u4E2D\u5173\u95ED\u5F53\u524Dtab*/    if (tabId) {        var objtab=parent.Ext.getCmp(tabId);        if (objtab) {            objtab.ownerCt.remove(objtab);            return;        }    }    if (parent.miracleView) {        objtab=parent.miracleView.viewPanel.getActiveTab();        if (objtab) {            objtab.ownerCt.remove(objtab)            return;        }    }}function checkNeedField(){    var isneeds=$("[isneed=true]:visible");    var msg="";    var hasCheckField={};    $.each(isneeds,function(n,isneed){        //var itemname=$(isneed).attr("name");        if (isneed.type=="checkbox") {            if (hasCheckField[isneed.name]) {return;}            strvalue=$("input[type=checkbox][name="+isneed.name+"]:checked").val()||"";            hasCheckField[isneed.name]=true;        }else{            var strvalue = isneed.tagName=='SPAN'?isneed.innerText:isneed.value;        }        if(strvalue.replace(/(^[\s\u3000]*)|([\s\u3000]*$)/g,"") == ""){            var fieldLabel;            try{fieldLabel=$(isneed).parent("td,th").prev().text();}catch(e){}            if (!fieldLabel) {fielLabel=isneed.name;}            msg =msg+ "\u8BF7\u586B\u5199" + fieldLabel + "\uFF01\n";            isneed.style.border = "1px solid red";        }    });    return msg;}//\u81EA\u5B9A\u4E49\u8868\u5355\u4F7F\u7528function mrSaveDoc(){   var msg=checkNeedField();    if(msg != ""){alert(msg);return false;}    getElement("mr_Save_").click();    //window.onunload=function(){(opener||parent).miracleView.refreshGrid()}}function mrEditDoc(){    var activeTab=$("#content div.form-table:visible")[0];    var id=activeTab?("&ActiveTab=" + activeTab.id):"";    location.href=location.href.replace(/\?opendocument/i,"?editdocument")+id;}var mrCloseDoc=CloseDoc;var createBeforeClose=function(msg,forSave) {    var hasPrompt=false;    return !forSave?function(){        if (GetItemValue("IsEditDoc",true)!=="1") return;        if (!hasPrompt && IsFormChanged()){            Ext.Msg.confirm("\u4FDD\u5B58\u63D0\u793A",msg||"\u6587\u6863\u8FD8\u6CA1\u6709\u4FDD\u5B58,\u662F\u5426\u5173\u95ED?",function(v){                if (v=="yes") {                    hasPrompt=true;                    CloseDoc();                }            });            return false;        }    }:function() {    if (GetItemValue("IsEditDoc",true)!=="1") return;        if (IsFormChanged()) {            Ext.Msg.show({                title: "\u4FDD\u5B58\u63D0\u793A",                msg: "\u6587\u4EF6\u5DF2\u7ECF\u4FEE\u6539,\u662F\u5426\u4FDD\u5B58?",                buttons: Ext.MessageBox.YESNOCANCEL,                icon: Ext.MessageBox.QUESTION,                fn: function(v) {                    if (v == "yes") {                        mrSaveDoc();                    }                    if (v == "no") {                        CloseDoc(null, true);                    }                }            });            return false;        }    }};function mrCommonOnload(){    //\u81EA\u5B9A\u4E49\u8868\u5355onload\u65F6\u4F1A\u81EA\u52A8\u6267\u884C\u7684\u4E00\u4E2A\u51FD\u6570    var arr=location.href.match(/ActiveTab=(\w+)/);       arr && $("#tab li:first").attr("text")!==arr[1] && $("#tab li[text='"+ arr[1] +"']").click();    if (typeof createBeforeClose=="function"){window.beforeCloseDoc=createBeforeClose(null,true)}}function IsNum(obj,Decimal){	//\u5224\u65AD\u8F93\u5165\u7684\u662F\u5426\u4E3A\u6570\u5B57,Decimal\u4E3A\u5C0F\u6570\u4F4D\u6570    if(!obj.value.match(/^[\+\-]?\d*?\.?\d*?$/)){        obj.value=obj.getAttribute("t_value");    }    else{        obj.setAttribute("t_value", obj.value);    }    if(obj.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/)){        obj.setAttribute("o_value", obj.value);    }    var DecimalStr="";    if(Decimal!=null){        for(var i=0;i<Decimal;i++){		   DecimalStr=DecimalStr+"\\d"	   }	   var re;	   if(Decimal!=0){    	       re=new RegExp("^(\\-)*(\\d+)\.("+DecimalStr+").*$");    	       obj.value=obj.value.replace(re,'$1$2.$3');    	   }else{            re=new RegExp("^(\\-)*(\\d+).*$");            obj.value=obj.value.replace(re,'$1$2');        }    } }//\u6821\u9A8C\u624B\u673A\u3001\u7535\u8BDD\u53F7\u7801//type:\u624B\u673Aor\u7535\u8BDDfunction phone(phoneNum, type) {	var reg = "";	var tip = "\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u53F7\u7801\n\n\u5982\uFF1A010-6480000\uFF0C15000000000";	if (type == "\u7535\u8BDD") {		reg = /^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/;		tip = "\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u7535\u8BDD\u53F7\u7801\n\n\u5982\uFF1A010-6480000";	} else if (type == "\u624B\u673A") {		reg = /(^(13[0-9]|15[012356789]|18[056789])\d{8}$)/;		tip = "\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801\n\n\u5982\uFF1A15000000000";	} else {		reg = /^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$|(^(13[0-9]|15[012356789]|18[056789])\d{8}$)/;	}	if (!reg.test(phoneNum)) {		alert(tip);		return false;	}}