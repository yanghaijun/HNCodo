/*\u6CE8\u610F:\u4E0B\u9762\u7684\u51FD\u6570\u7528\u4E8E\u53EF\u89C6\u5316\u5B9A\u4E49\u89C6\u56FE,\u53EF\u4EE5\u7528\u5230miracleView\u8FD9\u4E2A\u5168\u5C40\u53D8\u91CF*/function mrRemoveDoc(){    /*\u5220\u9664\u89C6\u56FE\u4E2D\u9009\u62E9\u6587\u6863*/    doViewAction({        confirmMsg:"\u662F\u5426\u8981\u5220\u9664\u9009\u4E2D\u7684\u6587\u6863?",        params:{ActionName:escape("\u5220\u9664\u5217\u8868\u9009\u62E9\u7684\u6587\u6863")}    });}function mrRemoveCdoc(){    /*\u5E94\u7528\u5E93\u4E2D\u5220\u9664\u9009\u4E2DCdoc*/    doViewAction({        confirmMsg:"\u662F\u5426\u8981\u5220\u9664\u9009\u4E2D\u7684\u6587\u6863?",        params:{ActionName:escape("\u5220\u9664\u9009\u5B9A\u6587\u6863")}    });}function mrRemoveAdoc(){    /*\u6211\u7684\u5DE5\u4F5C\u5E93\u4E2D\u5220\u9664\u9009\u4E2DAdoc*/    doViewAction({        confirmMsg:"\u662F\u5426\u8981\u5220\u9664\u9009\u4E2D\u7684\u6587\u6863?",        params:{ActionName:escape("\u5220\u9664\u6211\u7684\u5DE5\u4F5C\u6587\u6863")}    });}function mrRecoverCdoc(){    /*\u5E94\u7528\u5E93\u5F85\u5220\u9664\u4E2D\u6062\u590DCdoc*/    doViewAction({        confirmMsg:"\u662F\u5426\u8981\u5DF2\u6062\u590D\u9009\u4E2D\u7684\u6587\u6863?",        params:{ActionName:escape("\u6062\u590D\u9009\u5B9A\u6587\u6863")}    });}function mrRecoverAchive(){    /*\u5E94\u7528\u5E93\u5F85\u5F52\u6863\u4E2D\u53D6\u56DECdoc*/    doViewAction({        confirmMsg:"\u662F\u5426\u8981\u53D6\u56DE\u9009\u62E9\u7684\u6587\u4EF6\uFF1F",        params:{ActionName:escape("\u53D6\u56DE\u5F52\u6863\u6587\u6863")}    });}function mrCopy(){    /*\u590D\u5236*/    doViewAction({params:{ActionName:escape("\u590D\u5236")}});}function mrNewDoc(dbName,formName,openType,title){    /*\u65B0\u5EFA\u6587\u6863*/    var  url="/" + dbName + "/"+formName+"?OpenForm";    if (openType == "1") {        //openCenterWindowUrl(url,null,845,638);        openCenterWindowUrl(url,formName,845,638);    } else {        miracleView.openNewTabWindow(url,null,title||'\u65B0\u5EFA\u6587\u6863');    }}function GetViewSelectDoc(multi){    var ids=miracleView.getSelectedId();	var multi=multi||false;	if (!ids){		Ext.Msg.alert("\u63D0\u793A\uFF1A","\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u8981\u5904\u7406\u7684\u6587\u6863");		return "";	}	if (ids.length>1 && !multi){		Ext.Msg.alert("\u63D0\u793A\uFF1A","\u53EA\u80FD\u9009\u62E9\u4E00\u4E2A\u8981\u5904\u7406\u7684\u6587\u6863");		return "";	}    return ids.join(",");}function doViewAction(config){    /*\u9009\u62E9\u6587\u6863\u8C03\u7528\u4EE3\u7406\u5904\u7406\u7684\u516C\u7528\u51FD\u6570*/    var ids=miracleView.getSelections("SID");    var callAjax=function(){        var url = config.url || ("/" + DBPath + "/AgentGet_frmExtViewListDoAction?openagent");        var params=Ext.apply(config.params||{},{            DocUnid:ids!=null?ids.join(','):miracleView.viewName,            viewName:miracleView.viewName,            DocDB:miracleView.dbName        });        mrAjax(url,params,function(v){            miracleView.refreshGrid();            if (Ext.isFunction(config.fn)) {                config.fn.call(window,v);            }        });    }    if (!config.noSelection) {        if (!ids) {            Ext.Msg.alert("\u63D0\u793A",config.msg||"\u8BF7\u5148\u9009\u62E9\u8981\u5904\u7406\u7684\u6587\u6863");            return;        }    }    if (config.confirmMsg) {        Ext.Msg.confirm("\u63D0\u793A",config.confirmMsg,function(btn){            if (btn=="yes") {                callAjax();            }        });    }else callAjax();}function mrAjax(url,params,callback){    /*\u8C03\u7528\u540E\u53F0Ajax\u529F\u80FD*/    Ext.Ajax.request({        url:url,        success: function(v) {            if (v.responseText.indexOf("Error\uFF1A")==0) {                Ext.Msg.alert("\u63D0\u793A",v.responseText.right("Error\uFF1A"));                return;            }            if (Ext.isFunction(callback)) callback(v.responseText);        },        failure: function(v) {        	  if(v.responseText!=""){            	Ext.Msg.alert("\u8C03\u7528Ajax\u51FA\u9519:", v.responseText)            }        },        params:params    });}function mrExpandAll(){    var btn=arguments[0];    var type=btn.ownerCt.ownerCt instanceof Ext.grid.GridPanel;    miracleView.expandAll(type?"grid":"tree");}function mrCollapseAll(){    var btn=arguments[0];    var type=btn.ownerCt.ownerCt instanceof Ext.grid.GridPanel;    miracleView.collapseAll(type?"grid":"tree");}function mrSwitchToView(viewName,isTab){   if (isTab==false){       location.href="/"+SysDBPath+"/v_Key_frmView/"+viewName+"?OpenDocument&isTab=0"   }else{       location.href="/"+SysDBPath+"/v_Key_frmView/"+viewName+"?OpenDocument"   }}function showContextMenu(menuItems,e){	/*\u663E\u793A\u5F39\u51FA\u83DC\u5355\u7684\u51FD\u6570,e\u662F\u4E8B\u4EF6\u5BF9\u8C61,menuItem\u5982[{text:'\u83DC\u53551',handler:\u5904\u7406\u51FD\u6570}]*/	var menu=new Ext.menu.Menu({items:menuItems})	menu.on("itemclick",function(){menu.destroy();});	menu.showAt(e.getXY());}//tree\u62D6\u52A8function treeDrop(e){	if(e.point=='append'){//\u76EE\u5F55\u4E0B		parentNodeId=e.target.attributes.docUnid;		//alert('\u5F53\u524D"\u3010'+e.dropNode.text+'\u3011"\u88AB\u653E\u5230\u76EE\u5F55"\u3010'+e.target.text+'\u3011"\u4E0B\uFF01');	}   	else if(e.point=='above'){//\u4E0A\u9762		parentNodeId=e.target.parentNode.attributes.docUnid;		//alert('\u5F53\u524D"'+e.dropNode.text+'"\u653E\u5728\u4E86"'+e.target.text+'"\u4E0A\u9762\uFF01');      	}else if(e.point=='below'){//\u4E0B\u9762		parentNodeId=e.target.parentNode.attributes.docUnid;		//alert('\u5F53\u524D"'+e.dropNode.text+'"\u653E\u5728\u4E86"'+e.target.text+'"\u4E0B\u9762\uFF01');    	}	var parentNode=e.dropNode.parentNode;	var nodeList="";	Ext.each(parentNode.childNodes,function(node,i){		nodeList==""?nodeList=node.attributes.docUnid:nodeList=nodeList+","+node.attributes.docUnid;		//node.setText(i+1+"."+node.text.right("."));	});	var url="/"+SysDBPath+"/agent_dropTreeSortBy?openagent";	var parameter="&fldAppDBName="+miracleView.dbName+"&nodeList="+nodeList;	if(miracleView.viewName=="v_Sort_frmCDPZ"){		var ListNumber="\u5BFC\u822A\u83DC\u5355\u914D\u7F6E";	}	else if(miracleView.viewName=="v_Sort_frmBLBM"){		var ListNumber="\u529E\u7406\u90E8\u95E8";	}	parameter=parameter+"&currenRootId="+e.dropNode.attributes.docUnid+"&parentNodeId="+parentNodeId+"&ListNumber="+escape(ListNumber);	ajaxFunction(url,parameter);}function mrRemoveCustomView(viewName){    /*/\u901A\u8FC7\u89C6\u56FE\u540D\u79F0\u5220\u9664\u81EA\u5B9A\u4E49\u89C6\u56FE/*/    doViewAction({        url:"/" + miracleView.dbName + "/Agent_CustomViewRemove?openagent",        confirmMsg:"\u662F\u5426\u8981\u5220\u9664\u9009\u62E9\u7684\u89C6\u56FE?"    });}function CallFormAction(ActionName){	if(ActionName=="\u65B0\u5EFA"){		if (miracleView.isTabPanel)		{mrNewDoc(miracleView.dbName,"Memo",2,"\u65B0\u5EFA\u90AE\u4EF6");}		else		{parent.mrNewDoc(miracleView.dbName,"Memo",2,"\u65B0\u5EFA\u90AE\u4EF6");}		return;	}	if(ActionName=="\u8F6C\u53D1"){		//\u63D0\u53D6\u5DF2\u9009\u62E9\u7684\u5217\u8868\u6587\u6863UNID		var UnidList = GetViewSelectDoc(true);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wForward?OpenForm&ParentUNID="+UnidList+"&RespondedTo=2&Forward&AndLarAtt";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u8F6C\u53D1(\u4E0D\u5E26\u9644\u4EF6)"){		//\u63D0\u53D6\u5DF2\u9009\u62E9\u7684\u5217\u8868\u6587\u6863UNID		var UnidList = GetViewSelectDoc(true);		if(UnidList=="")return;				var url="/"+miracleView.dbName+"/wReply?OpenForm&ParentUNID="+UnidList+"&RespondedTo=2&Forward";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{		     var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u7B54\u590D"){		//\u63D0\u53D6\u5DF2\u9009\u62E9\u7684\u5217\u8868\u6587\u6863UNID		var UnidList = GetViewSelectDoc(false);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wReply?OpenForm&ParentUNID="+UnidList+"&RespondedTo=1&reply";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u7B54\u590D\u6240\u6709\u4EBA"){		var UnidList = GetViewSelectDoc(false);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wReply?OpenForm&ParentUNID="+UnidList+"&RespondedTo=1&replyall&reply";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u7B54\u590D(\u9644\u5E26\u539F\u6587)"){		var UnidList = GetViewSelectDoc(false);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wForward?OpenForm&ParentUNID="+UnidList+"&RespondedTo=1&ReplyWithHistory&AndLarAtt";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u7B54\u590D\u6240\u6709\u4EBA(\u9644\u5E26\u539F\u6587)"){		var UnidList = GetViewSelectDoc(false);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wForward?OpenForm&ParentUNID="+UnidList+"&RespondedTo=1&replyall&ReplyWithHistory&AndLarAtt";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u7B54\u590D(\u4E0D\u5E26\u9644\u4EF6)"){		var UnidList = GetViewSelectDoc(false);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wReply?OpenForm&ParentUNID="+UnidList+"&RespondedTo=1&ReplyWithHistory";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u7B54\u590D\u6240\u6709\u4EBA(\u4E0D\u5E26\u9644\u4EF6)"){		var UnidList = GetViewSelectDoc(false);		if(UnidList=="")return;		var url="/"+miracleView.dbName+"/wReply?OpenForm&ParentUNID="+UnidList+"&RespondedTo=1&replyall&ReplyWithHistory";		if(miracleView.isTabPanel){			miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}else{			var tbar=miracleView.gridPanel.getTopToolbar();		     tbar.items.each(function(btn){				if (btn.hideMenu) btn.hideMenu();			});			parent.miracleView.openNewTabWindow(url,null,'\u65B0\u5EFA\u90AE\u4EF6');		}		return;	}	if(ActionName=="\u65B0\u5EFA\u8054\u7CFB\u4EBA"){		mrNewDoc("afaddressbook.nsf","frmAddressBook",2,"\u65B0\u5EFA\u8054\u7CFB\u4EBA")		return;	}	if(ActionName=="\u5206\u7EC4\u8054\u7CFB\u4EBA"){		//\u5224\u65AD\u662F\u5426\u9009\u62E9\u4E86\u6587\u6863		var UnidList = GetViewSelectDoc(true);		if(UnidList=="")return;		var url = "/afaddressbook.nsf/frmExtTreeSelect?openForm"		heightx = 399;		if(miracleView.gridPanel.viewDispName == "\u672A\u5206\u7EC4\u8054\u7CFB\u4EBA"){			OpenExtWindow("categorywin",url,"\u5206\u7EC4\u8054\u7CFB\u4EBA",600,heightx,"ab","miracleView.refreshGrid()");		}else{			OpenExtWindow("categorywin",url,"\u5206\u7EC4\u8054\u7CFB\u4EBA",600,heightx,"ab","");		}	}	if(ActionName=="\u65B0\u5EFA\u89C4\u5219"){		var url="/"+miracleView.dbName+"/Mailrule?openform"		OpenExtWindow("YJGZ",url,"\u65B0\u5EFA\u89C4\u5219",680,450,"ab","","")		return;	}}//\u6807\u8BB0\u9009\u4E2D\u7684\u90AE\u4EF6\u4E3A\u5DF2\u8BFB\u6216\u8005\u672A\u8BFBfunction MailChange(readMode){	var UnidList = GetViewSelectDoc(true);	if(UnidList=="")return;	var url="/" +SysDBPath + "/AgentSet_MailDocReadStatus?openagent"	var Parameter = "&ReadMode=" + readMode +"&DBPath=" +escape(miracleView.dbName) + "&UNID=" + UnidList;	var returnmsg = ajaxFunction(url,Parameter,"text");	if (returnmsg!="OK")Ext.Msg.show({title:'\u7CFB\u7EDF\u63D0\u793A',msg:returnmsg,buttons: Ext.Msg.OK,icon: Ext.MessageBox.INFO,width:600});		//\u5237\u65B0GRID	miracleView.refreshGrid();}//\u6807\u8BB0\u90AE\u4EF6\u540E\u7EED\u7684\u91CD\u8981\u6027function SetFollowUp(readMode){	var UnidList = GetViewSelectDoc(true);	if(UnidList=="")return;	var url="/" +SysDBPath + "/AgentSet_MailDocFollowUpStatus?openagent"	var Parameter = "&ReadMode=" + readMode +"&DBPath=" +escape(miracleView.dbName) + "&UNID=" + UnidList;	if(readMode=="true"){		var url1="/" +SysDBPath + "/AgentGet_MailDocFollowUpStatu?openagent"		ListBox({        		url:url1,        		title:"\u540E\u7EED\u6807\u8BB0",        		fn:function(v){        			if(v){        				Parameter=Parameter + "&FollowUp=" + v;					var returnmsg = ajaxFunction(url,Parameter,"text");					miracleView.refreshGrid();					if (returnmsg!="OK")Ext.Msg.show({title:'\u7CFB\u7EDF\u63D0\u793A',msg:returnmsg,buttons: Ext.Msg.OK,icon: Ext.MessageBox.INFO,width:600});					//miracleView.refreshGrid();				}	   		}     	});     	}else{		var returnmsg1 = ajaxFunction(url,Parameter,"text");		if (returnmsg1!="OK")Ext.Msg.show({title:'\u7CFB\u7EDF\u63D0\u793A',msg:returnmsg1,buttons: Ext.Msg.OK,icon: Ext.MessageBox.INFO,width:600});	}	//return false;		//\u5237\u65B0GRID	miracleView.refreshGrid();}//\u8BBE\u7F6E\u79BB\u5F00\u529E\u516C\u5BA4\u9009\u9879function SetLeaveDoc(){;	var Url="/"+miracleView.dbName+"/OutOfOfficeProfile?OpenForm";	var win = new Ext.Window({		id           	: "selectwin",		title	     : "\u79BB\u5F00\u529E\u516C\u5BA4",		width	     : 520,		height	     : 424,		autoDestroy	: true,		resizable   	: false,		modal	     : true,		html	     	: '<iframe id="PreDoc" name="PreDoc" src="' + Url + '" width="100%" height="100%" scrolling="no"></iframe>',        	buttonAlign  	: "right"	});	//win.addButton({text:'\u786E\u5B9A'},function(){PreDoc.ReturnValue("a");});	//win.addButton({text:'\u5173\u95ED'},function(){win.close();});	//win.addButton({text:'\u542F\u52A8'},function(){PreDoc.ReturnValue("true");});	//win.addButton({text:'\u7981\u7528'},function(){PreDoc.ReturnValue("false");});	win.on("beforeclose",function(){		closewin("PreDoc");	})	win.show();}//\u8BBE\u7F6E\u77ED\u4FE1\u901A\u77E5function SetSendMSG(){	var url="/" +miracleView.dbName+ "/AgentGet_SendMSG?openagent"	var Parameter = "";	var returnmsg = ajaxFunction(url,Parameter);	if (returnmsg!="OK"){		url="/" +miracleView.dbName+ "/0/"+returnmsg+"?EditDocument";	}else{		url="/" +miracleView.dbName+ "/MailProfile?OpenForm";	}	url=url+"&datetime="+new Date();	OpenExtWindow("DXTZ",url,"\u77ED\u4FE1\u901A\u77E5",300,120,"ab");}//\u5F52\u6863function archive() {	var unidList = GetViewSelectDoc(true);	if (unidList != "") {		Ext.Msg.show({			title: '\u7CFB\u7EDF\u63D0\u793A',			msg: '\u5F52\u6863\u5C06\u4F1A\u5220\u9664\u90AE\u4EF6\uFF0C\u662F\u5426\u5F52\u6863\uFF1F',			buttons: Ext.Msg.YESNO,			width: 320,			icon: Ext.MessageBox.QUESTION,			fn: function(btn) {				if (btn == "yes") {					var url = "/" + miracleView.dbName+ "/Agent_Archive?OpenAgent";					var parameter = "&unidList=" + unidList;					var returnmsg = ajaxFunction(url, parameter);                        miracleView.refreshGrid();				}			}		});	}}//\u4ECE\u5217\u8868\u4E2D\u6DFB\u52A0\u8054\u7CFB\u4EBA\u4FE1\u606F\u5230\u4E2A\u4EBA\u901A\u8BAF\u5F55function AddToAddressBook(){		var senderList =GetViewSelectDoc(true);	if(senderList!=""){		var Url = "/" + DBPath + "/AgentAdd_AddressBook?openagent";		var Parameter = "&senderList=" + senderList;		var returnmsg = ajaxFunction(Url,Parameter);		if(returnmsg == "OK"){			returnmsg = "\u6210\u529F\u6DFB\u52A0\u8054\u7CFB\u4FE1\u606F\uFF0C\u8BF7\u5230\u4E2A\u4EBA\u901A\u8BAF\u5F55\u5217\u8868\u67E5\u770B\uFF01"		}		Ext.Msg.show({title:'\u7CFB\u7EDF\u63D0\u793A',msg:returnmsg,buttons: Ext.Msg.OK,icon: Ext.MessageBox.INFO,width:400});		}}// \u65B0\u5EFA\u6587\u4EF6\u5939function CreateFolder(){     var url = "/" + DBPath + "/frmCreateFolder?openForm";     url += "&Treeid=" + GetItemValue("Treeid",true);	CreateFolderWin(url,398);}// \u65B0\u5EFA\u6587\u4EF6\u5939EXT\u7A97\u53E3JSfunction CreateFolderWin(url,heightx){	 var updated = 0;      var win = new Ext.Window({		id           	: "renamewin",		title	     : "\u65B0\u5EFA\u6587\u4EF6\u5939",		width	     : 600,		height	     : heightx,		autoDestroy	: true,		resizable   	: false,		modal	     : true,		html	     	: '<iframe id="PreDoc" name="PreDoc" src="' + url + '" width="100%" height="100%" scrolling="no"></iframe>',        	buttonAlign  	: "right"       		});	win.addButton({text:'\u65B0\u5EFA' },function(){updated = 1;PreDoc.ReturnValue("a");});		win.addButton({text:'\u5220\u9664' },function(){updated = 1;PreDoc.ReturnValue("c");});	win.addButton({text:'\u5173\u95ED'},function(){win.close();});	win.on("beforeclose",function(){	     var tree =window.parent.Ext.getCmp("NavFolderTree");	     if (tree != null){	     if (tree.isVisible()){	     	if (updated == 1){	     		tree.root.reload();			}		}}	     closewin("PreDoc");	})	win.show();}//\u79FB\u5165\u6587\u4EF6\u5939function AddToFolder(ActionName){	var UnidList =GetViewSelectDoc(true);	if(UnidList=="")return;	var url = "/" + DBPath + "/frmSelectFolder?openForm";	OpenMoveToFolderWin(url,398);}//\u79FB\u5165\u6587\u4EF6\u5939EXT\u7A97\u53E3JSfunction OpenMoveToFolderWin(Url,heightx){	var win = new Ext.Window({		id           	: "selectwin",		title	     : "\u8BF7\u9009\u62E9\u6587\u4EF6\u5939",		width	     : 600,		height	     : heightx,		autoDestroy	: true,		resizable   	: false,		modal	     : true,		html	     	: '<iframe id="PreDoc" name="PreDoc" src="' + Url + '" width="100%" height="100%" scrolling="no"></iframe>',        	buttonAlign  	: "right"	});	var viewName=miracleView.gridPanel.viewDispName;	if(viewName == "\u6536\u4EF6\u7BB1" || viewName == "\u5E7F\u544A\u90AE\u4EF6" || viewName == "\u4E2A\u4EBA\u6587\u4EF6\u5939"){		win.addButton({text:' \u79FB\u52A8\u5230\u6587\u4EF6\u5939 '},function(){PreDoc.ReturnValue("move");});	}	if(viewName != "\u6536\u4EF6\u7BB1"){		win.addButton({text:' \u6DFB\u52A0\u5230\u6587\u4EF6\u5939 '},function(){PreDoc.ReturnValue("add");});	}	win.addButton({text:'\u5173\u95ED'},function(){win.close();});		win.on("beforeclose",function(){		closewin("PreDoc");	})	win.show();}